const data = {
  "options": [
    "abid",
    "mizan",
    "ifti",
    "reza",
    "shabib",
    "huzaifa",
    "sakib",
    "talha",
    "shehbaz",
    "abdulrehman"
  ],
  "trivia": [
    [("This guy worked the least in his own Master's thesis because we did it for him."), ("mizan")],
    [("Someone who used to say 'mera bhi ek din ayega' and his day has not yet come."), ("ifti")],
    [("Who says and writes 'bruv' the most in the group and is not remotely close to being British?"), ("shabib")],
    [("Quote: Is it because I am black?"), ("ifti")],
    [("This guy spilled hot tea in his pp in Abid's car."), ("shabib")],
    [("Legend has it that this dude is still batting in Creek park, playing Cricket, and is still not out."), ("sakib")],
    [("That one person who makes you feel like you are with your modeer/kafil because of his rizz."), ("abdulrehman")],
    [("You may be bad but who has absolutely the worst sense of maps and directions and can't remember roads?"), ("abid")],
    [("His dorm was our default place to be at AUS."), ("shabib")],
    [("This fool almost rekt someone by throwing a table tennis racket."), ("shabib")],
    [("This guy takes the crown of laziness and procrastination."), ("talha")],
    [("Who uses the N-word oddly often despite living in a country that can easily cancel him?"), ("shehbaz")],
    [("The title of 'aim noob' based on a famous story was bestowed upon him."), ("huzaifa")],
    [("Every group has that one friend who always captures moments and is the default photographer."), ("reza")],
    [("The guy said he can literally make any food in his house even though he never made any for us."), ("ifti")],
    [("This guy has had a clash/an argument with every single member of the group."), ("abid")],
    [("The van guy with a logo."), ("abdulrehman")],
    [("Who is the latest addition to our group?"), ("abdulrehman")],
    [("This gentleman pulled a Thanos flick to split the old Oxford-AUS group into the Secret group we have today."), ("shabib")],
    [("It took this legend 2+ years to buy/get a chair."), ("talha")],
    [("The ultimate rager in DotA."), ("abid")],
    [("The slowest eater in the group."), ("ifti")],
    [("Most seasonal hangouts are planned by him."), ("abid")],
    [("Presumably only he has the N-word pass."), ("ifti")],
    [("This guy has a lot of handshake stories."), ("abid")],
    [("This guy has a lot of Jinn stories."), ("abdulrehman")],
    [("Who slept through his entire uni life and miraculously made it?"), ("talha")],
    [("If there was any mufta in AUS, almost guaranteed you will find him there."), ("talha")],
    [("This sweet soul logged into person A's account, chatted with person B appearing as person A, and requested person B to be friends with him because person B had boycotted him."), ("mizan")],
    [("He has the longest arms, Ma shaa' Allah. That's why he is the best person to take group selfies."), ("mizan")],
    [("Who is into Bollywood stuff the most?"), ("mizan")],
    [("He is the first to step into fatherhood."), ("huzaifa")],
    [("Identify the only one of us to be living in Bangladesh."), ("mizan")],
    [("Select the best and the fastest driver among us."), ("abdulrehman")],
    [("Select the safest driver among us."), ("ifti")],
    [("Select the laziest driver among us."), ("abid")],
    [("If he paid money for every time he was picked up for a hangout, he would be legit broke by now."), ("abid")],
    [("He is the first to have an interracial marriage."), ("shabib")],
    [("He is crowned as the KFC King, always and forever."), ("abid")],
    [("He is the first to have performed Hajj, Ma shaa' Allah."), ("abid")],
    [("Who is the first among us to get married?"), ("mizan")],
    [("He is the civil engineer of the group."), ("mizan")],
    [("He is the chemical engineer of the group."), ("shabib")],
    [("He is the doctor of the group."), ("reza")],
    [("His informal title is 'little child lover'."), ("reza")],
    [("Select the first person you think of when it comes to programming."), ("abid")],
    [("Who do you think browses Facebook the most?"), ("mizan")],
    [("The only guy to not have a display picture on WhatsApp, guess who?"), ("ifti")],
    [("His OCD forces him to have the same username and sometimes profile picture on every website/app."), ("abid")],
    [("He is known for getting his knees exposed because of wearing shorts."), ("talha")],
    [("Who is the first person that comes to mind in Kandura?"), ("abdulrehman")],
    [("This guy HATES the constant mouse clicking sound when someone plays DotA nearby."), ("ifti")],
    [("He is the first to go for PhD studies."), ("sakib")],
    [("Every language he speaks - English, Urdu, Arabic, even Bengali - sounds like a cringy posh accent to many of us."), ("shabib")],
    [("Who is the first person Abid met from our group?"), ("sakib")],
    [("Who is the first person Sakib met from our group?"), ("abid")],
    [("Who is the first person Ifthikar met from our group?"), ("sakib")],
    [("Who is the first person Reza met from our group?"), ("mizan")],
    [("Who is the first person Mizan met from our group?"), ("reza")],
    [("Who is the first person Talha met from our group?"), ("ifti")],
    [("Who is the first person Shehbaz met from our group?"), ("abid")],
    [("The person that immediately comes to mind on the topic of AI (artificial intelligence)."), ("sakib")],
    [("This guy seems to never age, Ma shaa' Allah."), ("ifti")],
    [("If you ever want to ask for a file resource that you can't find, you ask this guy who then shares a Dropbox link."), ("abid")],
    [("He sweats instantly and easily and is intolerant to hot weather."), ("abid")],
    [("He became the school headboy once."), ("abid")],
    [("He was the president of Bangladesh Cultural Club in AUS."), ("shabib")],
    [("He was the president of Islamic Cultural Club in AUS."), ("abid")],
    [("He is the first to have memorized the Qur'an, Ma shaa' Allah."), ("abdulrehman")],
    [("Who is the first person Huzaifa met from our group?"), ("abid")],
    [("His company relocated him from the USA to the UAE for sometime."), ("shehbaz")],
    [("This guy lost his Emirates Driving Institute student permit card, didn't care, traveled abroad, traveled back, found it was with another one of us for years."), ("shehbaz")],
    [("This guy safekept an Emirates Driving Institute student permit card that belonged to another of us for years, and even returned it successfully."), ("talha")],
    [("The most punctual guy among us and has rarely ever made us wait whenever we pick him."), ("ifti")],
    [("His photo in the secret group display picture gives big dong energy."), ("shehbaz")],
    [("To reduce global warming, this fool was putting out a lit cigarette in the middle of the road while a car was about to run him over."), ("reza")],
    [("His best imitation in recitation is of Sheikh Sudais and many commended him, Ma shaa' Allah."), ("huzaifa")],
    [("He got popular in AUS for his Urdu poetry (Shayari)."), ("huzaifa")],
    [("We all know he expresses his brotherly love physically, meaning by beating and wrestling."), ("ifti")],
    [("In high school, a social studies teacher asked him to get out of the class in order to explain the word 'exterior'. Our guy thought he was being punished and it started to rain for him."), ("ifti")],
    [("He had a soccer mom car in AUS used to pick everybody and go for food/Karak."), ("abid")],
    [("We shoved him in the car trunk to smuggle him into AUS."), ("mizan")],
    [("He is the first to graduate from Heriot Watt."), ("mizan")],
    [("Who jokes the most about everyone being adopted by Abid?"), ("shabib")],
    [("The guy owns a powerful microphone making his voice ASMR in our calls."), ("shehbaz")],
    [("This legend joined DotA for a short while, sucked, got killed a lot and like really a lot, got raged on, left the game, and blames another one of us for not teaching patiently."), ("shabib")],
    [("He plays RuneScape regularly and is popular for it at his workplace."), ("abid")],
    [("He is the only real IT guy because of his patience in problem-solving, Ma shaa' Allah."), ("talha")],
    [("He is the first to achieve certification in cloud computing."), ("huzaifa")],
    [("In his graduation, he had a red gown instead of the typical black."), ("huzaifa")],
    [("He drives manual gear cars like a boss but has a driver's license for automatic cars."), ("abdulrehman")],
    [("We taunt him for honking unnecessarily when driving."), ("shabib")],
    [("Who drives with one foot on the car dashboard as if he is chilling in his living room?"), ("abdulrehman")],
    [("He had a successful sinus surgery in Pakistan."), ("abdulrehman")],
    [("Among siblings, he is the youngest and does not have any brother."), ("shehbaz")],
    [("Among siblings, he is the eldest and does not have any brother."), ("shabib")],
    [("Among siblings, he is not the eldest and does not have any sister."), ("mizan")],
    [("We call him 'Rajakar' for many reasons."), ("ifti")],
    [("If he is asked to speak in Arabic, the first phrase he would say is 'al-abwabu tuglaq'."), ("talha")],
    [("He has the best writing skills, Ma shaa' Allah."), ("shabib")],
    [("He has the best handwriting, Ma shaa' Allah. He even bested one of us in a competition."), ("ifti")],
    [("His family owns a Madrasah."), ("abdulrehman")],
    [("He knew his wife and her family long before their marriage."), ("shabib")],
    [("Through marriage, he extended his family in Oman."), ("shabib")],
    [("Through marriage, he extended his family in Qatar."), ("reza")],
    [("Through marriage, he extended his family in Indonesia."), ("sakib")],
    [("He has work experience as a motel keeper."), ("huzaifa")],
    [("Thanks to someone's tweet, a certain individual strongly believed that metro runs on petrol. Whose tweet was it?"), ("mizan")],
    [("He is a pro in 8 Ball Pool mobile game and has played for years."), ("mizan")],
    [("We have missed his presence physically (aka he has been abroad) for the longest time."), ("huzaifa")],
    [("This guy was so skilled in Counter Strike 1.6 that he was kicked out of the server because people thought he was hacking, Ma shaa' Allah."), ("shehbaz")],
    [("He once played table tennis at AUS by being seated on a chair because of how easy his opponent was."), ("sakib")],
    [("Who is the hidden ogre that can be spotted at the start of the game?"), ("talha")],
    [("He was the last among us to join Al-Sadiq and had a tough time fitting in."), ("abdulrehman")],
    [("His family runs a perfume business."), ("reza")],
    [("This game is made for everyone but dedicated to one and only boy - guess who?"), ("reza")],
    [("We met a server at a Karak place near AUS who had the same name as one of us"), ("shabib")],
    [("Who suffered a hand injury after being involved in a 3-car accident?"), ("talha")],
    [("Who suffered a trauma because his friend drove at a high speed over a speed bump and the car sort of flew?"), ("talha")],
    [("This genius is known for pouring water into Karak if it is too sweet for him."), ("ifti")],
    [("Who gets super insecure and acts sus if he spots any police nearby?"), ("ifti")],
    [("This legendary driver almost ran over a deer on the way to Oman."), ("reza")],
    [("Ice tea? Nope. Letting hot tea cool down then drink? Yes. Guess who?"), ("ifti")],
    [("Who says this phrase the most: 'Not cool bro' or 'Not cool man'?"), ("ifti")],
    [("He was the only sane person to warn us multiple times NOT to drive the van over the wet sand dune in Al-Madam."), ("ifti")],
    [("Who uses the word 'Shonamoni'?"), ("shabib")],
    [("Who uses the word 'Sesra'?"), ("shabib")],
    [("Who is the oldest in our group?"), ("mizan")],
    [("He tried to act in Tahnun's short film as a Keralite and said 'Ende porelle'."), ("shabib")],
    [("Despite not being an Indian, he stayed in India for a long time."), ("mizan")],
    [("He almost fought with another one of us because the other fool displaced his chair and made him fall. Don't worry, we held him back from creating any fight and calmed him down."), ("mizan")],
    [("In cricket, this guy bowls in the same style as Malinga."), ("mizan")],
    [("In high school he used to have a special snake attack where he would hit on the head using the tip of his fingers."), ("mizan")],
    [("A broker offered him saying 'jayga?' and he declined with the most brutal response: 'tera behen hoga toh jayga'."), ("mizan")],
    [("He is the embassador of #TeamIfti."), ("talha")],
    [("He is one of the most health conscious ones and is the most consistent about maintaining it, Ma shaa' Allah."), ("shehbaz")],
    [("He is easily the least toxic DotA player."), ("shehbaz")],
    [("He is the hardest to tilt/trigger."), ("shehbaz")],
    [("This legend has driven the most number of unique cars."), ("abdulrehman")],
    [("He is crowned as the policitian of the group."), ("sakib")],
    [("Who has hiked the most in the group, especially in mountainous places?"), ("sakib")],
    [("He was called 'noob' and the R-word by an Oxfordian in a comment on a Facebook post."), ("huzaifa")],
    [("He has full professional proficiency in Arabic."), ("abdulrehman")],
    [("He was a hardworking student in high school and frequently went to another one of us for tuitions."), ("abdulrehman")],
    [("His beard length is longer than average, beautifully black and well-maintained, Ma shaa' Allah."), ("abdulrehman")],
    [("Who has a habit of high-fiving after cracking or hearing a good joke?"), ("abdulrehman")],
    [("This guy has 'wasta' in the government level."), ("abdulrehman")],
    [("This man has trained in kickboxing."), ("abdulrehman")],
    [("He serves as a volunteer in international Qur'an competitions in Dubai."), ("abdulrehman")],
    [("He is a walking, talking meme himself and his meme imitation is on point."), ("talha")],
    [("He did not learn to speak until he was around 5, and now he doesn't stop talking."), ("talha")],
    [("If he sleeps in white sheets, there is no difference between him and a dead body because he does not move a muscle or make any noise."), ("talha")],
    [("Who goes either absolutely logical or full retard mode and there is no in between for him?"), ("talha")],
    [("Who shows up on the group seasonally, shares long messages, then disappears again."), ("huzaifa")],
    [("This gentleman when he newly joined the group, suggested to add an individual whose personality was 180 degree different from us."), ("talha")],
    [("The only one to ever wear shorts to a formal presentation in AUS and he was one of the presenters."), ("talha")],
    [("He has a habit of reading the news from newspapers."), ("talha")],
    [("He not only uses abbreviations in chatting but also uses them in real life when speaking, such as 'T-B-H'."), ("talha")],
    [("In high school, he had 'Past 10 syndrome' in which if he tried to work past his sleep time, he would seem very drunk."), ("reza")],
    [("His work often requires him to stay up for 24+ hours."), ("reza")],
    [("He started a new wedding trend where we take a photo by cross holding each other's hands."), ("reza")],
    [("This dude was into calisthenics."), ("reza")],
    [("This man got hit in the balls the most by various game balls."), ("reza")],
    [("He once held down a hung boxing pillow for another one of us to do a fly kick. The kick fell in his balls, not the pillow. Guess the victim."), ("reza")],
    [("He has published or helped publish the most number of academic research papers."), ("sakib")],
    [("He created a machine learning model to classify the different 'Maqamat' (recitation styles)."), ("sakib")],
    [("In high school, he was into writing fictional stories with another friend of his."), ("reza")],
    [("We smuggled someone into AUS through one's car trunk. Whose car was it?"), ("sakib")],
    [("His family lives in a two-floor villa in the UAE."), ("reza")],
    [("He learnt German."), ("reza")],
    [("He was in top 7% on Duolingo."), ("reza")],
    [("He shared recordings of his full workout routine to motivate our lazy asses."), ("reza")],
    [("He is known for making autistic sounds especially when yawning."), ("shehbaz")],
    [("His face resembles that of Levy Rozman the chess master (you can Google him)."), ("shehbaz")],
    [("He has the joystick/controller for Microsoft Flight Simulator."), ("shehbaz")],
    [("Whenever he travels, it takes a long time for his PC to be shipped to him."), ("shehbaz")],
    [("He is on top of the gaming chair chain. When he buys a new one, he sells the old one to another one of us and he does the same, and so on."), ("shehbaz")],
    [("He had the most useless position in Islamic Cultural Club in AUS before another one of us replaced him. The position was 'Sports Coordinator'."), ("shehbaz")],
    [("This guy was an active member of Islamic Cultural Club in AUS when Abid was the president. He refused to become a board member because he was too busy with Pakistan Cultural Club #priorities."), ("huzaifa")],
    [("His hair almost looks like an afro."), ("shehbaz")],
    [("He liked KFC breasts and was sometimes (not always) willing to exchange his KFC thighs and legs with others."), ("shehbaz")],
    [("This man ensures that he gets plenty of sleep, otherwise he cannot function properly and that becomes a sight to watch."), ("shehbaz")],
    [("He was born a support player in DotA."), ("shehbaz")],
    [("He became a Hafiz later in life and is the second one among us."), ("sakib")],
    [("This man started growing long hair."), ("sakib")],
    [("The Zomato guy of the group. He knows a great deal about dine-in places."), ("sakib")],
    [("This legend once suggested a random restaurant from Zomato and we had the most awkward experience there. The restaurant owner's wife spoke to us, for some reason."), ("sakib")],
    [("This brave man had a fight in school and as a result, got a black eye."), ("sakib")],
    [("His 'dab on them haters' during a mountain hike was made into a GIF."), ("sakib")],
    [("He is a lone wolf when it comes to traveling."), ("sakib")],
    [("Who rode a scooter about the city during his travel?"), ("sakib")],
    [("He had a heated debate with another one of us because he left some trash, like empty juice box, in the other guy's car."), ("huzaifa")],
    [("He was the default front-seat passenger in the old hangout car Toyota Innova."), ("huzaifa")],
    [("Almost every single week, his family would eat out at a new restaurant."), ("huzaifa")],
    [("He used to prepare Hookah for his father at home."), ("huzaifa")],
    [("Who is the biggest cat lover in the group?"), ("huzaifa")],
    [("Who named his cat 'Simba'?"), ("huzaifa")],
    [("This dude is the worst swimming instructor ever. Instead of trying to teach another one of us how to swim, he just died laughing while the other guy drowned."), ("huzaifa")],
    [("Sometime before marriage, the Imaam provided a questionnaire to him and his wife to write, share and discuss their expectations."), ("huzaifa")],
    [("He first went to Canada, came back to the UAE, then lastly moved to the USA for settling down."), ("huzaifa")]
  ],
};

const questionElement = document.getElementById('question');
const optionButtons = document.getElementsByClassName('option');
const correctScore = document.getElementById('correct-score');
const wrongScore = document.getElementById('wrong-score');
let currentIndex = 1;
let questionIndex = 0;
let questionIndices = [];
let options = [];

function shuffle(array) {
  let i = array.length,
    j = 0,
    temp;

  while (i--) {
    j = Math.floor(Math.random() * (i + 1));
    temp = array[i];
    array[i] = array[j];
    array[j] = temp;
  }

  return array;
}

function init() {
  for (let i = 0; i < data.trivia.length; i += 1) {
    questionIndices.push(i);
  }
  questionIndices = shuffle(questionIndices);
  document.getElementById('question-count').innerText = questionIndices.length;
  loadQuestion();
}

function loadQuestion() {
  if (questionIndex >= questionIndices.length) {
    endGame();
    return;
  }
  const idx = questionIndices[questionIndex];
  const answer = data.trivia[idx][1];
  questionElement.innerText = data.trivia[idx][0];

  let allOptions = shuffle(data.options);
  allOptions.splice(allOptions.indexOf(answer), 1);
  options = shuffle([answer, ...allOptions.slice(0, 3)]);


  for (let i = 0; i < options.length; i++) {
    optionButtons[i].value = options[i];
    if (optionButtons[i].value === answer) {
      optionButtons[i].addEventListener('click', correctAnswer);
    } else {
      optionButtons[i].addEventListener('click', wrongAnswer);
    }
    optionButtons[i].children[0].src = 'images/' + options[i] + '.png';
  }
  questionIndex += 1;
}

function playAudio(audio) {
  return new Promise(res => {
    audio.play();
    audio.onended = res;
  });
}

function getButton(event) {
  let target = event.target;
  if (event.target.nodeName.toLowerCase() === 'img')
    target = event.target.parentElement;
  const idx = options.indexOf(target.value);
  return optionButtons[idx];
}

async function correctAnswer(event) {
  correctScore.innerText = parseInt(correctScore.innerText) + 1;
  const button = getButton(event);
  button.classList.add('correct');
  button.removeEventListener('click', correctAnswer);
  for (let i = 0; i < optionButtons.length; i++) {
    optionButtons[i].removeEventListener('click', wrongAnswer);
  }
  const num = Math.floor(Math.random() * 5) + 1;
  let audio;
  if (['abid'].includes(button.value))
    audio = new Audio('audios/abid-correct-1.mp3');
  else
    audio = new Audio('audios/' + button.value + '-correct-' + num + '.mp4');
  await playAudio(audio);
  button.classList.remove('correct');
  loadQuestion();
}

async function wrongAnswer(event) {
  wrongScore.innerText = parseInt(wrongScore.innerText) + 1;
  const button = getButton(event);
  const num = Math.floor(Math.random() * 5) + 1;
  let audio;
  if (['abid'].includes(button.value))
    audio = new Audio('audios/abid-wrong-1.mp3');
  else
    audio = new Audio('audios/' + button.value + '-wrong-' + num + '.mp4');
  await playAudio(audio);
}

function startGame() {
  const startPageDivs = document.getElementsByClassName('start-page');
  for (const div of startPageDivs)
    div.style.display = 'none';
  document.getElementById('main-page').style.display = 'block';
  document.getElementById('refresh').style.display = 'block';
}

function endGame() {
  document.getElementById('main-page').style.display = 'none';
  document.getElementById('game-over-page').style.display = 'block';
  document.getElementById('correct-score-game-over').innerText = correctScore.innerText;
  document.getElementById('wrong-score-game-over').innerText = wrongScore.innerText;
}

init();
